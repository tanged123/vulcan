name: Format Check

on: push

jobs:
  format:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
          
      - uses: DeterminateSystems/nix-installer-action@main
      
      - uses: DeterminateSystems/magic-nix-cache-action@main

      - name: Check formatting
        run: |
          if ! nix fmt -- --fail-on-change; then
            echo ""
            echo "âŒ Code is not formatted correctly!"
            echo "ğŸ’¡ Run 'nix fmt' locally to fix formatting"
            echo "ğŸ’¡ Or run './scripts/install-hooks.sh' to auto-format on every commit"
            exit 1
          fi
          echo "âœ… All files are properly formatted!"
